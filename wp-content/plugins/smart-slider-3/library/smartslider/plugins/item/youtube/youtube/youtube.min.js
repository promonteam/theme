N2Require("ItemYoutube",["Item"],["smartSlider"],function(e,t,r,o){"use strict";function i(){this.type="youtube",t.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(t.Item.prototype),i.prototype.constructor=i,i.needSize=!0,i.prototype.added=function(){this.needFill=["youtubeurl","image","start"],nextend.smartSlider.generator.registerField(e("#item_youtubeyoutubeurl")),nextend.smartSlider.generator.registerField(e("#item_youtubeimage")),nextend.smartSlider.generator.registerField(e("#item_youtubestart"))},i.prototype.getName=function(e){return e.youtubeurl},i.prototype.parseAll=function(r){var o=this.values.youtubeurl!=r.youtubeurl;if(t.Item.prototype.parseAll.apply(this,arguments),""==r.image&&(r.image="$system$/images/placeholder/video.png"),r.image=nextend.imageHelper.fixed(r.image),o){var i=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,n=r.youtubeurl.match(i);n?NextendAjaxHelper.getJSON("https://www.googleapis.com/youtube/v3/videos?id="+encodeURI(n[2])+"&part=snippet&key=AIzaSyC3AolfvPAPlJs-2FgyPJdEEKS6nbPHdSM").done(e.proxy(function(t){if(t.items.length){var r=t.items[0].snippet.thumbnails,o=r.maxres||r.standard||r.high||r.medium||r["default"],i=o.url;"{video_url}"==this.values.youtubeurl&&(i=i.replace(n[2],"{video_id}")),e("#item_youtubeimage").val(i).trigger("change")}},this)).fail(function(e){nextend.notificationCenter.error(e.error.errors[0].message)}):nextend.notificationCenter.error("The provided URL does not match any known YouTube url or code!")}},i.prototype.fitLayer=function(){return!0},i.prototype._render=function(e,t){return parseInt(t.playbutton)||e.find(".n2-video-play").remove(),e},i.prototype._render=function(t){var r=e('<div class="n2-ow"></div>').css({width:"100%",height:"100%",minHeight:"50px",background:"url("+t.image+") no-repeat 50% 50%",backgroundSize:"cover"});parseInt(t.playbutton)&&e('<div class="n2-video-play n2-ow"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><g fill="none" fill-rule="evenodd"><circle cx="24" cy="24" r="24" fill="#000" opacity=".6"/><path fill="#FFF" d="M19.8 32c-.124 0-.247-.028-.36-.08-.264-.116-.436-.375-.44-.664V16.744c.005-.29.176-.55.44-.666.273-.126.592-.1.84.07l10.4 7.257c.2.132.32.355.32.595s-.12.463-.32.595l-10.4 7.256c-.14.1-.31.15-.48.15z"/></g></svg></div>').appendTo(r),this.$item.append(r)},i});